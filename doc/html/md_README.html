<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Multicol-SLAM: !!!!This is an early version of MultiCol-SLAM!!!!</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Multicol-SLAM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">!!!!This is an early version of MultiCol-SLAM!!!! </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>MultiCol-SLAM</h1>
<p><b>Author</b>: <a href="http://www.ipf.kit.edu/english/staff_urban_steffen.php">Steffen Urban</a> (urbste at googlemail.com).</p>
<p>MultiCol-SLAM is a multi-fisheye camera SLAM system. We adapt the SLAM system proposed in <a href="https://github.com/raulmur/ORB_SLAM">ORB-SLAM</a> and <a href="https://github.com/raulmur/ORB_SLAM2">ORB-SLAM2</a> and extend it for the use with fisheye and multi-fisheye camera systems.</p>
<h3>News</h3>
<ul>
<li>25/10/2016 added paper: <a href="https://arxiv.org/abs/1610.07336">Paper</a></li>
<li>See a video here: <a href="https://youtu.be/ggZqsiePUq8">VIDEO</a></li>
</ul>
<p>The novel methods and concepts included in this new version are:</p>
<ul>
<li>MultiKeyframes</li>
<li>Generic camera model (Scaramuzza's polynomial model).</li>
<li>MultiCol - a generic method for bundle adjustment for multi-camera systems.</li>
<li>a hyper graph (g2o) formulation of MultiCol</li>
<li>dBRIEF and mdBRIEF a distorted and a online learned, masked version of BRIEF.</li>
<li>Multi-camera loop closing</li>
<li>minimal (non)-central absolute pose estimation (3 pts) instead of EPnP which is non-minimal (6 pts)</li>
</ul>
<p>In terms of performance the following things were modified:</p><ul>
<li>exchanged all tranformations and vectors from cv::Mat to cv::Matx and cv::Vec</li>
<li>changed matrix access (descriptors, images) from .at to .ptr()</li>
<li>set terminate criteria for bundle adjustment and pose estimation using g2o::SparseOptimizerTerminateAction</li>
</ul>
<p>A <b>paper</b> of the proposed SLAM system will follow. Here some short descriptions on how the multi-camera integration works.</p>
<p>The MultiCol model is explained extensively in the paper given below. Here we briefly recapitulate the content: The MultiCol model is given by: </p><div class="image">
<img src="resources/MultiCol.png"  width="500"/>
</div>
<p>the indices are object point <b>i</b>, observed at time <b>t</b>, in camera <b>c</b>. The camera projection is given by  and we chose a general projection function, making this model applicable to a varity of prevalent (central) cameras, like perspective, fisheye and omnidirectional.</p>
<p>For a single camera, we could omit the matrix M_t. This yields the classic collinearity equations. Latter is depicted in the following figure. Each observation m' has two indices, i.e. <b>t</b> and <b>i</b>. </p><div class="image">
<img src="resources/singleCamera.png"  width="500"/>
</div>
<p>To handle multi-camera systems, the body frame is introduced, i.e. a frame that describes the motion of the multi-camera rig: </p><div class="image">
<img src="resources/BodyFrameConcept.png"  width="500"/>
</div>
<p>If we are optimizing the exterior orientation of our multi-camera system, we are actually looking for an estimate of matrix M_t. Now each observation has three indices.</p>
<p>The graphical representation of MultiCol can be realized in a hyper-graph and g2o can be used to optimize vertices of this graph: </p><div class="image">
<img src="resources/MultiCol_as_hypergraph.png"  width="980"/>
</div>
<h1>1. Related Publications:</h1>
<p>{UrbanMultiColSLAM16, Title={{MultiCol-SLAM} - A Modular Real-Time Multi-Camera SLAM System}, Author={Urban, Steffen and Hinz, Stefan}, Journal={arXiv preprint arXiv:1610.07336}, Year={2016} } {UrbanMultiCol2016, Title = {{MultiCol Bundle Adjustment: A Generic Method for Pose Estimation, Simultaneous Self-Calibration and Reconstruction for Arbitrary Multi-Camera Systems}}, Author = {Urban, Steffen and Wursthorn, Sven and Leitloff, Jens and Hinz, Stefan}, Journal = International Journal of Computer Vision, Year = {2016}, Pages = {1&ndash;19} } {urban2015improved, Title = {{Improved Wide-Angle, Fisheye and Omnidirectional Camera Calibration}}, Author = {Urban, Steffen and Leitloff, Jens and Hinz, Stefan}, Journal = {ISPRS Journal of Photogrammetry and Remote Sensing}, Year = {2015}, Pages = {72&ndash;79}, Volume = {108}, Publisher = {Elsevier}, }</p>
<h1>2. Requirements</h1>
<ul>
<li>C++11 compiler</li>
<li>As the accuracy and speed of the SLAM system also depend on the hardware, we advice you to run the system on a strong CPU. We mainly tested the system using a laptop with i7-3630QM @2.4GHz and 16 GB of RAM running Win 7 x64. So anything above that should be fine.</li>
</ul>
<h1>3. Camera calibration</h1>
<p>We use a rather generic camera model, and thus MultiCol-SLAM should work with any prevalent central camera. To calibrate your cameras follow the instructions on <a href="https://github.com/urbste/ImprovedOcamCalib">link</a>. The systems expects a calibration file with the following structure: </p><pre class="fragment"># Camera Parameters. Adjust them!
# Camera calibration parameters camera back
Camera.Iw: 754
Camera.Ih: 480

# hyperparameters
Camera.nrpol: 5
Camera.nrinvpol: 12

# forward polynomial f(\rho)
Camera.a0: -209.200757992065
Camera.a1: 0.0 
Camera.a2: 0.00213741670953883
Camera.a3: -4.2203617319086e-06
Camera.a4: 1.77146086919594e-08

# backward polynomial rho(\theta)
Camera.pol0: 293.667187375663
.... and the rest pol1-pol10
Camera.pol11: 0.810799620714366

# affine matrix
Camera.c: 0.999626131079017
Camera.d: -0.0034775192597376
Camera.e: 0.00385134991673147

# principal point
Camera.u0: 392.219508388648
Camera.v0: 243.494438476351
</pre><p>You can find example files in ./Examples/Lafida</p>
<h1>4. Multi-camera calibration</h1>
<p>You can find example files in ./Examples/Lafida TODO</p>
<h1>5.Dependencies:</h1>
<h2>Pangolin</h2>
<p>For visualization. Get the instructions here: <a href="https://github.com/stevenlovegrove/Pangolin">Pangolin</a></p>
<h2>OpenCV 3</h2>
<p>Required is at least <b>OpenCV 3.0</b>. The library can be found at: <a href="https://github.com/opencv/opencv">OpenCV</a>.</p>
<h2>Eigen 3</h2>
<p>Required by g2o. Version 3.2.9 is included in the ./ThirdParty folder. Other version can be found at <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen</a>.</p>
<h2>OpenGV</h2>
<p>OpenGV can be found at: <a href="https://github.com/laurentkneip/opengv">OpenGV</a>. It is also included in the ./ThirdParty folder. We use OpenGV for re-localization (GP3P) and relative orientation estimation during initialization (Stewenius).</p>
<h2>DBoW2 and g2o</h2>
<p>As ORB-SLAM2 we use modified versions of DBoW2 and g2o for place recognition and optimization respectively. Both are included in the ./ThirdParty folder. The original versions can be found here: <a href="https://github.com/dorian3d/DBoW2">DBoW2</a>, <a href="https://github.com/RainerKuemmerle/g2o">g2o</a>.</p>
<h1>6. Build MultiCol-SLAM:</h1>
<h2>Ubuntu:</h2>
<p>This is tested with Ubuntu 16.04. Before you build MultiCol-SLAM, you have to build and install OpenCV and Pangolin. This can for example be done by running the following:</p>
<h4>Build Pangolin:</h4>
<pre class="fragment">sudo apt-get install libglew-dev cmake
git clone https://github.com/stevenlovegrove/Pangolin.git
cd Pangolin
mkdir build
cd build
cmake -DCPP11_NO_BOOST=1 ..
make -j
</pre><h4>Build OpenCV 3.1</h4>
<p>This is just a suggestion on how to build OpenCV 3.1. There a plenty of options. Also some packages might be optional. </p><pre class="fragment">sudo apt-get install libgtk2.0-dev pkg-config libavcodec-dev libavformat-dev libswscale-dev python-dev python-numpy libtbb2 libtbb-dev libjpeg-dev libpng-dev libtiff-dev libjasper-dev libdc1394-22-dev
git clone https://github.com/Itseez/opencv.git
cd opencv
mkdir build
cd build
cmake -D CMAKE_BUILD_TYPE=RELEASE -D WITH_CUDA=OFF ..
make -j
sudo make install
</pre><p> this will take some time...</p>
<h4>Build MultiCol-SLAM</h4>
<p>git clone <a href="https://github.com/urbste/MultiCol-SLAM.git">https://github.com/urbste/MultiCol-SLAM.git</a> MultiCol-SLAM cd MultiCol-SLAM chmod +x build.sh ./build.sh</p>
<p>for the rest run the build.sh This will create a library and an executable <b>multi_col_slam_lafida</b>, that you can run as shown in 7. below.</p>
<h2>Windows:</h2>
<p>This description assumes that you are familiar with building libraries using cmake and Visual Studio. Required is at least Visual Studio 2013. The first step is to build <b>Pangolin</b>.</p><ul>
<li>Download or clone <a href="https://github.com/stevenlovegrove/Pangolin">Pangolin</a>.</li>
<li>Run cmake to create a VS project in $PATH_TO_PANGOLIN$/build.</li>
<li>You can add options if you like, but the most basic set of options is sufficient for MultiCol-SLAM and should build without issues.</li>
<li>Open build/Pangolin.sln switch to Release and build the solution (ALL_BUILD)</li>
</ul>
<p>Next build <b>OpenCV 3.1</b>.</p><ul>
<li>Download or clone <a href="https://github.com/opencv/opencv">OpenCV 3.1</a>.</li>
<li>Run cmake to create a VS project in $PATH_TO_OpenCV$/build.</li>
<li>You might want to switch of building the CUDA libraries as this takes a long time</li>
<li>Open $PATH_TO_OpenCV$/build/OpenCV.sln switch to Release and build the solution. Open folder CMakeTargets. Right click on INSTALL and select build.</li>
</ul>
<p>Now download or clone MultiCol-SLAM. Next build DBoW2:</p><ul>
<li>Run cmake to create a VS project in $MultiCol-SLAM_PATH$/ThirdParty/DBoW2/build</li>
<li>If you get configuration errors, you likely did not set the OpenCV_DIR</li>
<li>Set this path to $PATH_TO_OpenCV$/build/install and run Generate</li>
<li>$MultiCol-SLAM_PATH$/ThirdParty/DBoW2/build/DBoW2.sln, switch to Release and build the solution</li>
</ul>
<p>Next build g2o:</p><ul>
<li>Run cmake to create a VS project in $MultiCol-SLAM_PATH$/ThirdParty/g2o/build</li>
<li>If you get any errors, you might want to set the EIGEN3_INCLUDE_DIR. Either you set it to your own version of Eigen or use the version that is provided in the ThirdParty folder $MultiCol-SLAM_PATH$/ThirdParty/Eigen.</li>
<li>Hit Generate and you will get the solution g2o.sln. Open it, select Release and build the solution.</li>
</ul>
<p>In a last step, we will build OpenGV. Unfortunately this takes quite some time under Windows (hours).</p><ul>
<li>Run cmake to create a VS project in $MultiCol-SLAM_PATH$/ThirdParty/OpenGV/build</li>
<li>Open $MultiCol-SLAM_PATH$/ThirdParty/OpenGV/build/OpenGV.sln switch to Release and build the solution</li>
</ul>
<p>Finally, we can build MultiCol-SLAM:</p><ul>
<li>Run cmake to create a VS project in $MultiCol-SLAM_PATH$/build</li>
<li>If you get any errors:</li>
<li>Set OpenCV_DIR: $PATH_TO_OpenCV$/build/install</li>
<li>Set Pangolin_DIR: $PATH_TO_PANGOLIN$/build/src</li>
<li>Open $MultiCol-SLAM_PATH$/build/MultiCol-SLAM.sln and build the solution (ALL_BUILD)</li>
</ul>
<h1>7. Run examples</h1>
<p>By now you should have compiled all libraries and MultiCol-SLAM. If everthing went well, you will find an executable in the folder ./Examples/Lafida/Release if you are running Windows and ./</p>
<h2><a href="http://www.ipf.kit.edu/lafida.php">Lafida</a></h2>
<p>First download the indoor dynamic dataset: <a href="http://www2.ipf.kit.edu/~pcv2016/downloads/indoor_dynamic.zip">dataset</a> Then extract the folder, e.g. to the folder </p><pre class="fragment">$HOME$/Downloads/IndoorDynamic
</pre><p>The executable <b>multi_col_slam_lafida</b> expects 4 paths. The first is the path to the vocabulary file. The second is the path to the settings file. The third is the path to the calibration files. The fourth is the path to the images. In our example, we could run MultiCol-SLAM: </p><pre class="fragment">./Examples/Lafida/multi_col_slam_lafida ./Examples/small_orb_omni_voc_9_6.yml  ./Examples/Lafida/Slam_Settings_indoor1.yaml ./Examples/Lafida/ $HOME$/Downloads/IndoorDynamic</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
